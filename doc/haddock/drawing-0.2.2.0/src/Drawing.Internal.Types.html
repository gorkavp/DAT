<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Drawing.Internal.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Encoding.Internal</span></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">data</span><span> </span><span id="Drawing"><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-var">Drawing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-11"></span><span>      </span><span id="Fill"><span class="annot"><a href="Drawing.Internal.Types.html#Fill"><span class="hs-identifier hs-var">Fill</span></a></span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Outline"><span class="annot"><a href="Drawing.Internal.Types.html#Outline"><span class="hs-identifier hs-var">Outline</span></a></span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CoordinatePlane"><span class="annot"><a href="Drawing.Internal.Types.html#CoordinatePlane"><span class="hs-identifier hs-var">CoordinatePlane</span></a></span></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Transformed"><span class="annot"><a href="Drawing.Internal.Types.html#Transformed"><span class="hs-identifier hs-var">Transformed</span></a></span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Colored"><span class="annot"><a href="Drawing.Internal.Types.html#Colored"><span class="hs-identifier hs-var">Colored</span></a></span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Blank"><span class="annot"><a href="Drawing.Internal.Types.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Many"><span class="annot"><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-var">Many</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- diff lists</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- | 'Drawing's are 'Semigroup's. The composing function is the overlapping</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- (the right drawing is drawn over the left one).</span><span>
</span><span id="line-21"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096053"><span id="local-6989586621679096055"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="annottext">Drawing
</span><a href="Drawing.Internal.Types.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span><span> </span><span id="local-6989586621679096051"><span class="annot"><span class="annottext">&lt;&gt; :: Drawing -&gt; Drawing -&gt; Drawing
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621679096050"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096050"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096050"><span class="hs-identifier hs-var">d2</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span id="local-6989586621679096049"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096049"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="Drawing.Internal.Types.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096049"><span class="hs-identifier hs-var">d1</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679096048"><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096048"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679096047"><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096047"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><span class="annottext">([Drawing] -&gt; [Drawing]) -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096048"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">([Drawing] -&gt; [Drawing])
-&gt; ([Drawing] -&gt; [Drawing]) -&gt; [Drawing] -&gt; [Drawing]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096047"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679096045"><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096045"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679096044"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096044"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">([Drawing] -&gt; [Drawing]) -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096043"><span class="annot"><span class="annottext">[Drawing]
</span><a href="#local-6989586621679096043"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096045"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096044"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; [Drawing] -&gt; [Drawing]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Drawing]
</span><a href="#local-6989586621679096043"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>    </span><span id="local-6989586621679096042"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096042"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679096041"><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096041"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><span class="annottext">([Drawing] -&gt; [Drawing]) -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096040"><span class="annot"><span class="annottext">[Drawing]
</span><a href="#local-6989586621679096040"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096042"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; [Drawing] -&gt; [Drawing]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679096041"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">[Drawing]
</span><a href="#local-6989586621679096040"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span id="local-6989586621679096039"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096039"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679096038"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096038"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><span class="annottext">([Drawing] -&gt; [Drawing]) -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096037"><span class="annot"><span class="annottext">[Drawing]
</span><a href="#local-6989586621679096037"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096039"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; [Drawing] -&gt; [Drawing]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679096038"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; [Drawing] -&gt; [Drawing]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Drawing]
</span><a href="#local-6989586621679096037"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | 'Drawing's are 'Monoid's. The identity is a 'blank' (completely transparent)</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- drawing and the composing function is the overlapping (the right drawing is</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- drawn over the left one).</span><span>
</span><span id="line-38"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096031"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679096029"><span class="annot"><span class="annottext">mempty :: Drawing
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="Drawing.Internal.Types.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679096027"><span class="annot"><span class="annottext">mappend :: Drawing -&gt; Drawing -&gt; Drawing
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; Drawing -&gt; Drawing
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096021"><span id="local-6989586621679096023"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679096002"><span class="annot"><span class="annottext">toEncoding :: Drawing -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Fill"><span class="hs-identifier hs-type">Fill</span></a></span><span> </span><span id="local-6989586621679096000"><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621679096000"><span class="hs-identifier hs-var">sh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fll&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Shape -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621679096000"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Outline"><span class="hs-identifier hs-type">Outline</span></a></span><span> </span><span id="local-6989586621679095997"><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621679095997"><span class="hs-identifier hs-var">sh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Otl&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Shape -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Shape
</span><a href="#local-6989586621679095997"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="Drawing.Internal.Types.html#CoordinatePlane"><span class="hs-identifier hs-var">CoordinatePlane</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding
forall a. Encoding' a -&gt; Encoding
</span><span class="hs-identifier hs-var">wrapArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Crd&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transformed"><span class="hs-identifier hs-type">Transformed</span></a></span><span> </span><span id="local-6989586621679095995"><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095995"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679095994"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095994"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Trn&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding' InArray -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Transform -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095995"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095994"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Colored"><span class="hs-identifier hs-type">Colored</span></a></span><span> </span><span id="local-6989586621679095993"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095993"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679095992"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095992"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Col&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding' InArray -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095993"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Drawing -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095992"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="Drawing.Internal.Types.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>        </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding
forall a. Encoding' a -&gt; Encoding
</span><span class="hs-identifier hs-var">wrapArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bln&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679095991"><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679095991"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Mny&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Drawing] -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Drawing] -&gt; [Drawing]
</span><a href="#local-6989586621679095991"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679095988"><span class="annot"><span class="annottext">toJSON :: Drawing -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Drawing.toJSON: Not yet implemented&quot;</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | A point on the x-y plane.</span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="Shape"><span class="annot"><a href="Drawing.Internal.Types.html#Shape"><span class="hs-identifier hs-var">Shape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>      </span><span id="Rect"><span class="annot"><a href="Drawing.Internal.Types.html#Rect"><span class="hs-identifier hs-var">Rect</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>        </span><span class="hs-comment">-- width, height</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Path"><span class="annot"><a href="Drawing.Internal.Types.html#Path"><span class="hs-identifier hs-var">Path</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Ellipse"><span class="annot"><a href="Drawing.Internal.Types.html#Ellipse"><span class="hs-identifier hs-var">Ellipse</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>     </span><span class="hs-comment">-- X-radius, Y-radius</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TextS"><span class="annot"><a href="Drawing.Internal.Types.html#TextS"><span class="hs-identifier hs-var">TextS</span></a></span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#TextAnchor"><span class="hs-identifier hs-type">TextAnchor</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095976"><span id="local-6989586621679095978"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679095957"><span class="annot"><span class="annottext">toEncoding :: Shape -&gt; Encoding
</span><a href="#local-6989586621679095957"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Rect"><span class="hs-identifier hs-type">Rect</span></a></span><span> </span><span id="local-6989586621679095956"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095956"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679095955"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095955"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rct&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding' InArray -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095956"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095955"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679095954"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679095954"><span class="hs-identifier hs-var">closed</span></a></span></span><span> </span><span id="local-6989586621679095953"><span class="annot"><span class="annottext">[Point]
</span><a href="#local-6989586621679095953"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pth&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding' InArray -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679095954"><span class="hs-identifier hs-var">closed</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Point] -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">[Point]
</span><a href="#local-6989586621679095953"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Ellipse"><span class="hs-identifier hs-type">Ellipse</span></a></span><span> </span><span id="local-6989586621679095952"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095952"><span class="hs-identifier hs-var">rx</span></a></span></span><span> </span><span id="local-6989586621679095951"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095951"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ell&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding' InArray -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095952"><span class="hs-identifier hs-var">rx</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095951"><span class="hs-identifier hs-var">ry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#TextS"><span class="hs-identifier hs-type">TextS</span></a></span><span> </span><span id="local-6989586621679095950"><span class="annot"><span class="annottext">TextAnchor
</span><a href="#local-6989586621679095950"><span class="hs-identifier hs-var">anchor</span></a></span></span><span> </span><span id="local-6989586621679095949"><span class="annot"><span class="annottext">TextAnchor
</span><a href="#local-6989586621679095949"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><span class="annottext">Encoding' InArray -&gt; Encoding
</span><span class="hs-identifier hs-var">tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Txt&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding' InArray -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">TextAnchor -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">TextAnchor
</span><a href="#local-6989586621679095950"><span class="hs-identifier hs-var">anchor</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding' InArray
forall a b. Encoding' a -&gt; Encoding' b -&gt; Encoding' InArray
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">TextAnchor -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">TextAnchor
</span><a href="#local-6989586621679095949"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679095946"><span class="annot"><span class="annottext">toJSON :: Shape -&gt; Value
</span><a href="#local-6989586621679095946"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">Shape
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Shape.toJSON: Not yet implemented&quot;</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">data</span><span> </span><span id="Color"><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-var">Color</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RGB"><span class="annot"><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095939"><span id="local-6989586621679095941"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679095920"><span class="annot"><span class="annottext">toEncoding :: Color -&gt; Encoding
</span><a href="#local-6989586621679095920"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span id="local-6989586621679095919"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095919"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679095918"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095918"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679095917"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095917"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>    </span><span class="hs-comment">-- encode to a CSS string</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Encoding) -&gt; String -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rgb(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall {a}. RealFrac a =&gt; a -&gt; String
</span><a href="#local-6989586621679095916"><span class="hs-identifier hs-var">to255</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095919"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall {a}. RealFrac a =&gt; a -&gt; String
</span><a href="#local-6989586621679095916"><span class="hs-identifier hs-var">to255</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095918"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall {a}. RealFrac a =&gt; a -&gt; String
</span><a href="#local-6989586621679095916"><span class="hs-identifier hs-var">to255</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095917"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>            </span><span id="local-6989586621679095916"><span class="annot"><span class="annottext">to255 :: a -&gt; String
</span><a href="#local-6989586621679095916"><span class="hs-identifier hs-var hs-var">to255</span></a></span></span><span> </span><span id="local-6989586621679095903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095903"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Int) -&gt; a -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095903"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">255</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679095897"><span class="annot"><span class="annottext">toJSON :: Color -&gt; Value
</span><a href="#local-6989586621679095897"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Color.toJSON: Not yet implemented&quot;</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- Utility functions.</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-type">fence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-94"></span><span id="fence"><span class="annot"><span class="annottext">fence :: Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var hs-var">fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Drawing.Internal.Types.html#wrapNum"><span class="hs-identifier hs-type">wrapNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-97"></span><span id="wrapNum"><span class="annot"><span class="annottext">wrapNum :: Double -&gt; Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#wrapNum"><span class="hs-identifier hs-var hs-var">wrapNum</span></a></span></span><span> </span><span id="local-6989586621679095892"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095892"><span class="hs-identifier hs-var">lim</span></a></span></span><span> </span><span id="local-6989586621679095891"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095891"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095891"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095891"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095892"><span class="hs-identifier hs-var">lim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095892"><span class="hs-identifier hs-var">lim</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Drawing.Internal.Types.html#fromRGB"><span class="hs-identifier hs-type">fromRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-101"></span><span id="fromRGB"><span class="annot"><span class="annottext">fromRGB :: Double -&gt; Double -&gt; Double -&gt; Color
</span><a href="Drawing.Internal.Types.html#fromRGB"><span class="hs-identifier hs-var hs-var">fromRGB</span></a></span></span><span> </span><span id="local-6989586621679095887"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095887"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span id="local-6989586621679095886"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095886"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span id="local-6989586621679095885"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095885"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Color
</span><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095887"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095886"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095885"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Based on the algorithm from the CSS3 specification.</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Drawing.Internal.Types.html#fromHSL"><span class="hs-identifier hs-type">fromHSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-105"></span><span id="fromHSL"><span class="annot"><span class="annottext">fromHSL :: Double -&gt; Double -&gt; Double -&gt; Color
</span><a href="Drawing.Internal.Types.html#fromHSL"><span class="hs-identifier hs-var hs-var">fromHSL</span></a></span></span><span> </span><span id="local-6989586621679095883"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095883"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span id="local-6989586621679095882"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095882"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621679095881"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095881"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Color
</span><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095880"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095879"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095878"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679095874"><span class="annot"><span class="annottext">h :: Double
</span><a href="#local-6989586621679095874"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#wrapNum"><span class="hs-identifier hs-var">wrapNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095883"><span class="hs-identifier hs-var">h'</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621679095872"><span class="annot"><span class="annottext">s :: Double
</span><a href="#local-6989586621679095872"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095882"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679095871"><span class="annot"><span class="annottext">l :: Double
</span><a href="#local-6989586621679095871"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095881"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679095867"><span class="annot"><span class="annottext">m1 :: Double
</span><a href="#local-6989586621679095867"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095871"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095866"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679095866"><span class="annot"><span class="annottext">m2 :: Double
</span><a href="#local-6989586621679095866"><span class="hs-identifier hs-var hs-var">m2</span></a></span></span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095871"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095871"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095872"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095871"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095872"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095871"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095872"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679095880"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679095880"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679095847"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095874"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679095879"><span class="annot"><span class="annottext">g :: Double
</span><a href="#local-6989586621679095879"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679095847"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095874"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679095878"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679095878"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679095847"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095874"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679095847"><span class="annot"><span class="annottext">convert :: Double -&gt; Double
</span><a href="#local-6989586621679095847"><span class="hs-identifier hs-var hs-var">convert</span></a></span></span><span> </span><span id="local-6989586621679095800"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679095847"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679095847"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095867"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095866"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095867"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095866"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095867"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095866"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095867"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095800"><span class="hs-identifier hs-var">hn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095867"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Drawing.Internal.Types.html#toRGB"><span class="hs-identifier hs-type">toRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span id="toRGB"><span class="annot"><span class="annottext">toRGB :: Color -&gt; (Double, Double, Double)
</span><a href="Drawing.Internal.Types.html#toRGB"><span class="hs-identifier hs-var hs-var">toRGB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span id="local-6989586621679095796"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095796"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679095795"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095795"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679095794"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095794"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095796"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095795"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095794"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Drawing.Internal.Types.html#toHSL"><span class="hs-identifier hs-type">toHSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span id="toHSL"><span class="annot"><span class="annottext">toHSL :: Color -&gt; (Double, Double, Double)
</span><a href="Drawing.Internal.Types.html#toHSL"><span class="hs-identifier hs-var hs-var">toHSL</span></a></span></span><span> </span><span id="local-6989586621679095792"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095792"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#hue"><span class="hs-identifier hs-var">hue</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095792"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#saturation"><span class="hs-identifier hs-var">saturation</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095792"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#luminosity"><span class="hs-identifier hs-var">luminosity</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095792"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Drawing.Internal.Types.html#hue"><span class="hs-identifier hs-type">hue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-132"></span><span id="hue"><span class="annot"><span class="annottext">hue :: Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#hue"><span class="hs-identifier hs-var hs-var">hue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span id="local-6989586621679095788"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679095787"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679095786"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095784"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095783"><span class="hs-identifier hs-var">epsilon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095784"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095784"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095784"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095784"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679095785"><span class="annot"><span class="annottext">hi :: Double
</span><a href="#local-6989586621679095785"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679095784"><span class="annot"><span class="annottext">lo :: Double
</span><a href="#local-6989586621679095784"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095788"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095787"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095786"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679095783"><span class="annot"><span class="annottext">epsilon :: Double
</span><a href="#local-6989586621679095783"><span class="hs-identifier hs-var hs-var">epsilon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.000001</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Drawing.Internal.Types.html#saturation"><span class="hs-identifier hs-type">saturation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-144"></span><span id="saturation"><span class="annot"><span class="annottext">saturation :: Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#saturation"><span class="hs-identifier hs-var hs-var">saturation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span id="local-6989586621679095776"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095776"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679095775"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095775"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679095774"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095774"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095773"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095772"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095771"><span class="hs-identifier hs-var">epsilon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095773"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095772"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095773"><span class="hs-identifier hs-var">hi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095772"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679095773"><span class="annot"><span class="annottext">hi :: Double
</span><a href="#local-6989586621679095773"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095776"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095775"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095774"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679095772"><span class="annot"><span class="annottext">lo :: Double
</span><a href="#local-6989586621679095772"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095776"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095775"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095774"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679095771"><span class="annot"><span class="annottext">epsilon :: Double
</span><a href="#local-6989586621679095771"><span class="hs-identifier hs-var hs-var">epsilon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.000001</span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Drawing.Internal.Types.html#luminosity"><span class="hs-identifier hs-type">luminosity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-153"></span><span id="luminosity"><span class="annot"><span class="annottext">luminosity :: Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#luminosity"><span class="hs-identifier hs-var hs-var">luminosity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span id="local-6989586621679095764"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095764"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679095763"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095763"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679095762"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095762"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095761"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095760"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679095760"><span class="annot"><span class="annottext">hi :: Double
</span><a href="#local-6989586621679095760"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095764"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095763"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095762"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679095761"><span class="annot"><span class="annottext">lo :: Double
</span><a href="#local-6989586621679095761"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095764"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095763"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095762"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Drawing.Internal.Types.html#lighter"><span class="hs-identifier hs-type">lighter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-159"></span><span id="lighter"><span class="annot"><span class="annottext">lighter :: Double -&gt; Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#lighter"><span class="hs-identifier hs-var hs-var">lighter</span></a></span></span><span> </span><span id="local-6989586621679095754"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095754"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679095753"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095753"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Color
</span><a href="Drawing.Internal.Types.html#fromHSL"><span class="hs-identifier hs-var">fromHSL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#hue"><span class="hs-identifier hs-var">hue</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095753"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#saturation"><span class="hs-identifier hs-var">saturation</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095753"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#luminosity"><span class="hs-identifier hs-var">luminosity</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095753"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095754"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Drawing.Internal.Types.html#light"><span class="hs-identifier hs-type">light</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-163"></span><span id="light"><span class="annot"><span class="annottext">light :: Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#light"><span class="hs-identifier hs-var hs-var">light</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#lighter"><span class="hs-identifier hs-var">lighter</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.15</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Drawing.Internal.Types.html#dark"><span class="hs-identifier hs-type">dark</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-166"></span><span id="dark"><span class="annot"><span class="annottext">dark :: Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#dark"><span class="hs-identifier hs-var hs-var">dark</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#lighter"><span class="hs-identifier hs-var">lighter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.15</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Drawing.Internal.Types.html#brighter"><span class="hs-identifier hs-type">brighter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-169"></span><span id="brighter"><span class="annot"><span class="annottext">brighter :: Double -&gt; Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#brighter"><span class="hs-identifier hs-var hs-var">brighter</span></a></span></span><span> </span><span id="local-6989586621679095749"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095749"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679095748"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095748"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Color
</span><a href="Drawing.Internal.Types.html#fromHSL"><span class="hs-identifier hs-var">fromHSL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#hue"><span class="hs-identifier hs-var">hue</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095748"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Drawing.Internal.Types.html#fence"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#saturation"><span class="hs-identifier hs-var">saturation</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095748"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095749"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; Double
</span><a href="Drawing.Internal.Types.html#luminosity"><span class="hs-identifier hs-var">luminosity</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679095748"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Drawing.Internal.Types.html#bright"><span class="hs-identifier hs-type">bright</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-173"></span><span id="bright"><span class="annot"><span class="annottext">bright :: Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#bright"><span class="hs-identifier hs-var hs-var">bright</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#brighter"><span class="hs-identifier hs-var">brighter</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.25</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Drawing.Internal.Types.html#dull"><span class="hs-identifier hs-type">dull</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-176"></span><span id="dull"><span class="annot"><span class="annottext">dull :: Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#dull"><span class="hs-identifier hs-var hs-var">dull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Color -&gt; Color
</span><a href="Drawing.Internal.Types.html#brighter"><span class="hs-identifier hs-var">brighter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.25</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">type</span><span> </span><span id="FillStyle"><span class="annot"><a href="Drawing.Internal.Types.html#FillStyle"><span class="hs-identifier hs-var">FillStyle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">type</span><span> </span><span id="OutlineStyle"><span class="annot"><a href="Drawing.Internal.Types.html#OutlineStyle"><span class="hs-identifier hs-var">OutlineStyle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Color"><span class="hs-identifier hs-type">Color</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">type</span><span> </span><span id="TextAnchor"><span class="annot"><a href="Drawing.Internal.Types.html#TextAnchor"><span class="hs-identifier hs-var">TextAnchor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | An affine transformation.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- An affine transformation is any transformation that preserves collinearity (i.e., all points lying on a line initially</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- still lie on a line after transformation) and ratios of distances (e.g., the midpoint of a line segment remains</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- the midpoint after transformation). An affine transformation is also called an affinity.</span><span>
</span><span id="line-194"></span><span class="hs-keyword">data</span><span> </span><span id="Transform"><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-var">Transform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Transform"><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-var">Transform</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_tr11"><span class="annot"><span class="annottext">Transform -&gt; Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var hs-var">_tr11</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span id="_tr12"><span class="annot"><span class="annottext">Transform -&gt; Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var hs-var">_tr12</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span id="_tr21"><span class="annot"><span class="annottext">Transform -&gt; Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var hs-var">_tr21</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span id="_tr22"><span class="annot"><span class="annottext">Transform -&gt; Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var hs-var">_tr22</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span id="_tr31"><span class="annot"><span class="annottext">Transform -&gt; Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var hs-var">_tr31</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span id="_tr32"><span class="annot"><span class="annottext">Transform -&gt; Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var hs-var">_tr32</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">}</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | 'Transform's are 'Semigroup's. `&lt;&gt;` is</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- the composition of transformations.</span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095732"><span id="local-6989586621679095734"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095711"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095711"><span class="hs-identifier hs-var">a11</span></a></span></span><span> </span><span id="local-6989586621679095710"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095710"><span class="hs-identifier hs-var">a12</span></a></span></span><span> </span><span id="local-6989586621679095709"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095709"><span class="hs-identifier hs-var">a21</span></a></span></span><span> </span><span id="local-6989586621679095708"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095708"><span class="hs-identifier hs-var">a22</span></a></span></span><span> </span><span id="local-6989586621679095707"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095707"><span class="hs-identifier hs-var">a31</span></a></span></span><span> </span><span id="local-6989586621679095706"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095706"><span class="hs-identifier hs-var">a32</span></a></span></span><span> </span><span id="local-6989586621679095705"><span class="annot"><span class="annottext">&lt;&gt; :: Transform -&gt; Transform -&gt; Transform
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095704"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095704"><span class="hs-identifier hs-var">b11</span></a></span></span><span> </span><span id="local-6989586621679095703"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095703"><span class="hs-identifier hs-var">b12</span></a></span></span><span> </span><span id="local-6989586621679095702"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095702"><span class="hs-identifier hs-var">b21</span></a></span></span><span> </span><span id="local-6989586621679095701"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095701"><span class="hs-identifier hs-var">b22</span></a></span></span><span> </span><span id="local-6989586621679095700"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095700"><span class="hs-identifier hs-var">b31</span></a></span></span><span> </span><span id="local-6989586621679095699"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095699"><span class="hs-identifier hs-var">b32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-comment">{- [a11 a21 a31]   [b11 b21 b31]   [a11*b11+a21*b12 a11*b21+a21*b22 a11*b31+a21*b32+a31]
         - [a12 a22 a32] x [b12 b22 b32] = [a12*b11+a22*b12 a12*b21+a22*b22 a12*b31+a22*b32+a32]
         - [0   0   1  ]   [0   0   1  ]   [0               0               1                  ]
         -}</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095711"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095704"><span class="hs-identifier hs-var">b11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095709"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095703"><span class="hs-identifier hs-var">b12</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095711"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095702"><span class="hs-identifier hs-var">b21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095709"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095701"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095711"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095700"><span class="hs-identifier hs-var">b31</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095709"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095699"><span class="hs-identifier hs-var">b32</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095707"><span class="hs-identifier hs-var">a31</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>                    </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095710"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095704"><span class="hs-identifier hs-var">b11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095708"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095703"><span class="hs-identifier hs-var">b12</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095710"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095702"><span class="hs-identifier hs-var">b21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095708"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095701"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095710"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095700"><span class="hs-identifier hs-var">b31</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095708"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095699"><span class="hs-identifier hs-var">b32</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095706"><span class="hs-identifier hs-var">a32</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | 'Transform's are 'Monoid's. `mempty` is the identity transformation</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- (e.g.: @translation 0 0@, or @rotation 0@, ...) and `mappend` is</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- the composition of transformations.</span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095693"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679095692"><span class="annot"><span class="annottext">mempty :: Transform
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679095690"><span class="annot"><span class="annottext">mappend :: Transform -&gt; Transform -&gt; Transform
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform -&gt; Transform -&gt; Transform
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095685"><span id="local-6989586621679095688"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679095658"><span class="annot"><span class="annottext">show :: Transform -&gt; String
</span><a href="#local-6989586621679095658"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095657"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095657"><span class="hs-identifier hs-var">m11</span></a></span></span><span> </span><span id="local-6989586621679095656"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095656"><span class="hs-identifier hs-var">m12</span></a></span></span><span> </span><span id="local-6989586621679095655"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095655"><span class="hs-identifier hs-var">m21</span></a></span></span><span> </span><span id="local-6989586621679095654"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095654"><span class="hs-identifier hs-var">m22</span></a></span></span><span> </span><span id="local-6989586621679095653"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095653"><span class="hs-identifier hs-var">m31</span></a></span></span><span> </span><span id="local-6989586621679095652"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095652"><span class="hs-identifier hs-var">m32</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Transform &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095657"><span class="hs-identifier hs-var">m11</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095656"><span class="hs-identifier hs-var">m12</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095655"><span class="hs-identifier hs-var">m21</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095654"><span class="hs-identifier hs-var">m22</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095653"><span class="hs-identifier hs-var">m31</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095652"><span class="hs-identifier hs-var">m32</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095646"><span id="local-6989586621679095648"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679095643"><span class="annot"><span class="annottext">toEncoding :: Transform -&gt; Encoding
</span><a href="#local-6989586621679095643"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095642"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095642"><span class="hs-identifier hs-var">m11</span></a></span></span><span> </span><span id="local-6989586621679095641"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095641"><span class="hs-identifier hs-var">m12</span></a></span></span><span> </span><span id="local-6989586621679095640"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095640"><span class="hs-identifier hs-var">m21</span></a></span></span><span> </span><span id="local-6989586621679095639"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095639"><span class="hs-identifier hs-var">m22</span></a></span></span><span> </span><span id="local-6989586621679095638"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095638"><span class="hs-identifier hs-var">m31</span></a></span></span><span> </span><span id="local-6989586621679095637"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095637"><span class="hs-identifier hs-var">m32</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">[Double] -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095642"><span class="hs-identifier hs-var">m11</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095641"><span class="hs-identifier hs-var">m12</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095640"><span class="hs-identifier hs-var">m21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095639"><span class="hs-identifier hs-var">m22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095638"><span class="hs-identifier hs-var">m31</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095637"><span class="hs-identifier hs-var">m32</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679095634"><span class="annot"><span class="annottext">toJSON :: Transform -&gt; Value
</span><a href="#local-6989586621679095634"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">Transform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Transform.toJSON: Not yet implemented&quot;</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | A translation by the given distance vector.</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Drawing.Internal.Types.html#translation"><span class="hs-identifier hs-type">translation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span>
</span><span id="line-226"></span><span id="translation"><span class="annot"><span class="annottext">translation :: Point -&gt; Transform
</span><a href="Drawing.Internal.Types.html#translation"><span class="hs-identifier hs-var hs-var">translation</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095632"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095632"><span class="hs-identifier hs-var">dx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095631"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095631"><span class="hs-identifier hs-var">dy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095632"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095631"><span class="hs-identifier hs-var">dy</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | A scaling by the given x and y factors. Scaling</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- by a negative factor also reflects across that axis.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Drawing.Internal.Types.html#scaling"><span class="hs-identifier hs-type">scaling</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span>
</span><span id="line-232"></span><span id="scaling"><span class="annot"><span class="annottext">scaling :: Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#scaling"><span class="hs-identifier hs-var hs-var">scaling</span></a></span></span><span> </span><span id="local-6989586621679095629"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095629"><span class="hs-identifier hs-var">sx</span></a></span></span><span> </span><span id="local-6989586621679095628"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095628"><span class="hs-identifier hs-var">sy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095629"><span class="hs-identifier hs-var">sx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095628"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | An uniformly scaling by the given factor.</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- Dilating by a negative factor also reflects across the origin.</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- prop&gt; dilated s = scaled s s</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Drawing.Internal.Types.html#dilation"><span class="hs-identifier hs-type">dilation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span>
</span><span id="line-240"></span><span id="dilation"><span class="annot"><span class="annottext">dilation :: Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#dilation"><span class="hs-identifier hs-var hs-var">dilation</span></a></span></span><span> </span><span id="local-6989586621679095626"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095626"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#scaling"><span class="hs-identifier hs-var">scaling</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095626"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095626"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | A rotation by the given angle about the origin.</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- Angles are in radians.</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Drawing.Internal.Types.html#rotation"><span class="hs-identifier hs-type">rotation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span>
</span><span id="line-245"></span><span id="rotation"><span class="annot"><span class="annottext">rotation :: Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#rotation"><span class="hs-identifier hs-var hs-var">rotation</span></a></span></span><span> </span><span id="local-6989586621679095624"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095624"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095624"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095624"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095624"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095624"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">{-
[a b c]   [1 t 0]   [a t*a+b c]
[d e f] x [0 1 0] = [d t*d+e f]
[0 0 1]   [0 0 1]   [0 0     1]
-}</span><span>
</span><span id="line-253"></span><span class="annot"><a href="Drawing.Internal.Types.html#skewX"><span class="hs-identifier hs-type">skewX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span>
</span><span id="line-254"></span><span id="skewX"><span class="annot"><span class="annottext">skewX :: Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#skewX"><span class="hs-identifier hs-var hs-var">skewX</span></a></span></span><span> </span><span id="local-6989586621679095620"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095620"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095620"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">{-
[a b c]   [1 0 0]   [a+t*b b c]
[d e f] x [t 1 0] = [d+t*e e f]
[0 0 1]   [0 0 1]   [0     0 1]
-}</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Drawing.Internal.Types.html#skewY"><span class="hs-identifier hs-type">skewY</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span>
</span><span id="line-263"></span><span id="skewY"><span class="annot"><span class="annottext">skewY :: Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#skewY"><span class="hs-identifier hs-var hs-var">skewY</span></a></span></span><span> </span><span id="local-6989586621679095617"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095617"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">Transform :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Transform
</span><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tr11 :: Double
</span><a href="Drawing.Internal.Types.html#_tr11"><span class="hs-identifier hs-var">_tr11</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr12 :: Double
</span><a href="Drawing.Internal.Types.html#_tr12"><span class="hs-identifier hs-var">_tr12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095617"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr21 :: Double
</span><a href="Drawing.Internal.Types.html#_tr21"><span class="hs-identifier hs-var">_tr21</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr22 :: Double
</span><a href="Drawing.Internal.Types.html#_tr22"><span class="hs-identifier hs-var">_tr22</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr31 :: Double
</span><a href="Drawing.Internal.Types.html#_tr31"><span class="hs-identifier hs-var">_tr31</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tr32 :: Double
</span><a href="Drawing.Internal.Types.html#_tr32"><span class="hs-identifier hs-var">_tr32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Drawing.Internal.Types.html#isTranslation"><span class="hs-identifier hs-type">isTranslation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span id="isTranslation"><span class="annot"><span class="annottext">isTranslation :: Transform -&gt; Maybe Point
</span><a href="Drawing.Internal.Types.html#isTranslation"><span class="hs-identifier hs-var hs-var">isTranslation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095615"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095615"><span class="hs-identifier hs-var">m11</span></a></span></span><span> </span><span id="local-6989586621679095614"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095614"><span class="hs-identifier hs-var">m12</span></a></span></span><span> </span><span id="local-6989586621679095613"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095613"><span class="hs-identifier hs-var">m21</span></a></span></span><span> </span><span id="local-6989586621679095612"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095612"><span class="hs-identifier hs-var">m22</span></a></span></span><span> </span><span id="local-6989586621679095611"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095611"><span class="hs-identifier hs-var">m31</span></a></span></span><span> </span><span id="local-6989586621679095610"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095610"><span class="hs-identifier hs-var">m32</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095615"><span class="hs-identifier hs-var">m11</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095614"><span class="hs-identifier hs-var">m12</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095613"><span class="hs-identifier hs-var">m21</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095612"><span class="hs-identifier hs-var">m22</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Point -&gt; Maybe Point
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095611"><span class="hs-identifier hs-var">m31</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095610"><span class="hs-identifier hs-var">m32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Point
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Apply an affine transformation to a drawing.</span><span>
</span><span id="line-273"></span><span class="annot"><a href="Drawing.Internal.Types.html#transform"><span class="hs-identifier hs-type">transform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Drawing"><span class="hs-identifier hs-type">Drawing</span></a></span><span>
</span><span id="line-274"></span><span class="hs-comment">{- NOTE: Previous implementation did special treatment for cases:
 - But it seems more efficient to maintain the transformation matrix and generate better SVG code.
transform tr (Many drs)           = Many (transform tr &lt;$&gt; drs)
transform tr (Fill (Path closed ps) style)    = Fill (Path closed (transformPoint tr &lt;$&gt; ps)) style
transform tr (Outline (Path closed ps) style) = Outline (Path closed (transformPoint tr &lt;$&gt; ps)) style
 -}</span><span>
</span><span id="line-280"></span><span id="transform"><span class="annot"><span class="annottext">transform :: Transform -&gt; Drawing -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#transform"><span class="hs-identifier hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679095608"><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095608"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transformed"><span class="hs-identifier hs-type">Transformed</span></a></span><span> </span><span id="local-6989586621679095607"><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095607"><span class="hs-identifier hs-var">tr2</span></a></span></span><span> </span><span id="local-6989586621679095606"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095606"><span class="hs-identifier hs-var">dr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform -&gt; Drawing -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#Transformed"><span class="hs-identifier hs-var">Transformed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095608"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Transform -&gt; Transform -&gt; Transform
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095607"><span class="hs-identifier hs-var">tr2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095606"><span class="hs-identifier hs-var">dr</span></a></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Drawing.Internal.Types.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span id="local-6989586621679095605"><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095605"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679095604"><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095604"><span class="hs-identifier hs-var">dr</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform -&gt; Drawing -&gt; Drawing
</span><a href="Drawing.Internal.Types.html#Transformed"><span class="hs-identifier hs-var">Transformed</span></a></span><span> </span><span class="annot"><span class="annottext">Transform
</span><a href="#local-6989586621679095605"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Drawing
</span><a href="#local-6989586621679095604"><span class="hs-identifier hs-var">dr</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Apply an affine transformation to a point.</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Drawing.Internal.Types.html#transformPoint"><span class="hs-identifier hs-type">transformPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span>
</span><span id="line-285"></span><span id="transformPoint"><span class="annot"><span class="annottext">transformPoint :: Transform -&gt; Point -&gt; Point
</span><a href="Drawing.Internal.Types.html#transformPoint"><span class="hs-identifier hs-var hs-var">transformPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095602"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095602"><span class="hs-identifier hs-var">a11</span></a></span></span><span> </span><span id="local-6989586621679095601"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095601"><span class="hs-identifier hs-var">a12</span></a></span></span><span> </span><span id="local-6989586621679095600"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095600"><span class="hs-identifier hs-var">a21</span></a></span></span><span> </span><span id="local-6989586621679095599"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095599"><span class="hs-identifier hs-var">a22</span></a></span></span><span> </span><span id="local-6989586621679095598"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095598"><span class="hs-identifier hs-var">a31</span></a></span></span><span> </span><span id="local-6989586621679095597"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095597"><span class="hs-identifier hs-var">a32</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095596"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095596"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095595"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095595"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095602"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095600"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095595"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095598"><span class="hs-identifier hs-var">a31</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095601"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095599"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095595"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095597"><span class="hs-identifier hs-var">a32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Apply the linear part of an affine transformation (that's a linear tranformation,</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- ignoring the translation part) to a vector.</span><span>
</span><span id="line-290"></span><span class="annot"><a href="Drawing.Internal.Types.html#transformVector"><span class="hs-identifier hs-type">transformVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span id="transformVector"><span class="annot"><span class="annottext">transformVector :: Transform -&gt; Point -&gt; Point
</span><a href="Drawing.Internal.Types.html#transformVector"><span class="hs-identifier hs-var hs-var">transformVector</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Internal.Types.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679095593"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095593"><span class="hs-identifier hs-var">a11</span></a></span></span><span> </span><span id="local-6989586621679095592"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095592"><span class="hs-identifier hs-var">a12</span></a></span></span><span> </span><span id="local-6989586621679095591"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095591"><span class="hs-identifier hs-var">a21</span></a></span></span><span> </span><span id="local-6989586621679095590"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095590"><span class="hs-identifier hs-var">a22</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095589"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095589"><span class="hs-identifier hs-var">dx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095588"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095588"><span class="hs-identifier hs-var">dy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095593"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095589"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095591"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095588"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095592"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095589"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095590"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679095588"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-296"></span><span class="hs-keyword">type</span><span> </span><span id="Time"><span class="annot"><a href="Drawing.Internal.Types.html#Time"><span class="hs-identifier hs-var">Time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">data</span><span> </span><span id="Event"><span class="annot"><a href="Drawing.Internal.Types.html#Event"><span class="hs-identifier hs-var">Event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>          </span><span id="KeyDown"><span class="annot"><a href="Drawing.Internal.Types.html#KeyDown"><span class="hs-identifier hs-var">KeyDown</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="KeyUp"><span class="annot"><a href="Drawing.Internal.Types.html#KeyUp"><span class="hs-identifier hs-var">KeyUp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="MouseDown"><span class="annot"><a href="Drawing.Internal.Types.html#MouseDown"><span class="hs-identifier hs-var">MouseDown</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="MouseUp"><span class="annot"><a href="Drawing.Internal.Types.html#MouseUp"><span class="hs-identifier hs-var">MouseUp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="MouseMove"><span class="annot"><a href="Drawing.Internal.Types.html#MouseMove"><span class="hs-identifier hs-var">MouseMove</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Drawing.Internal.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="TimePassing"><span class="annot"><a href="Drawing.Internal.Types.html#TimePassing"><span class="hs-identifier hs-var">TimePassing</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Drawing.Internal.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span>     </span><span class="hs-comment">-- ^ The argument is the time in seconds since the previous 'TimePassing' event.</span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095569"><span id="local-6989586621679095579"><span class="annot"><span class="annottext">Event -&gt; Event -&gt; Bool
(Event -&gt; Event -&gt; Bool) -&gt; (Event -&gt; Event -&gt; Bool) -&gt; Eq Event
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Event -&gt; Event -&gt; Bool
$c/= :: Event -&gt; Event -&gt; Bool
== :: Event -&gt; Event -&gt; Bool
$c== :: Event -&gt; Event -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095545"><span id="local-6989586621679095547"><span id="local-6989586621679095566"><span class="annot"><span class="annottext">Int -&gt; Event -&gt; String -&gt; String
[Event] -&gt; String -&gt; String
Event -&gt; String
(Int -&gt; Event -&gt; String -&gt; String)
-&gt; (Event -&gt; String) -&gt; ([Event] -&gt; String -&gt; String) -&gt; Show Event
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Event] -&gt; String -&gt; String
$cshowList :: [Event] -&gt; String -&gt; String
show :: Event -&gt; String
$cshow :: Event -&gt; String
showsPrec :: Int -&gt; Event -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Event -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095507"><span id="local-6989586621679095538"><span id="local-6989586621679095541"><span id="local-6989586621679095543"><span class="annot"><span class="annottext">ReadPrec [Event]
ReadPrec Event
Int -&gt; ReadS Event
ReadS [Event]
(Int -&gt; ReadS Event)
-&gt; ReadS [Event]
-&gt; ReadPrec Event
-&gt; ReadPrec [Event]
-&gt; Read Event
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Event]
$creadListPrec :: ReadPrec [Event]
readPrec :: ReadPrec Event
$creadPrec :: ReadPrec Event
readList :: ReadS [Event]
$creadList :: ReadS [Event]
readsPrec :: Int -&gt; ReadS Event
$creadsPrec :: Int -&gt; ReadS Event
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span></pre></body></html>