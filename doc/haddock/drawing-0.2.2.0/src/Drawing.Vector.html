<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Drawing.Vector</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-type">^+^</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#%5E-%5E"><span class="hs-operator hs-type">^-^</span></a></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- | Additive group @v@.</span><span>
</span><span id="line-13"></span><span class="hs-keyword">class</span><span> </span><span id="AdditiveGroup"><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-var">AdditiveGroup</span></a></span></span><span> </span><span id="local-6989586621679097282"><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-comment">-- | The zero element: identity for '(^+^)'</span><span>
</span><span id="line-15"></span><span>  </span><span id="zeroV"><span class="annot"><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-type">zeroV</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-comment">-- | Add vectors</span><span>
</span><span id="line-17"></span><span>  </span><span id="%5E%2B%5E"><span class="annot"><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-type">(^+^)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-comment">-- | Additive inverse</span><span>
</span><span id="line-19"></span><span>  </span><span id="negateV"><span class="annot"><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-type">negateV</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-comment">-- | Group subtraction</span><span>
</span><span id="line-21"></span><span>  </span><span id="%5E-%5E"><span class="annot"><a href="Drawing.Vector.html#%5E-%5E"><span class="hs-operator hs-type">(^-^)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097282"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span id="local-6989586621679097176"><span id="local-6989586621679097173"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097173"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#%5E-%5E"><span class="hs-operator hs-var hs-var">^-^</span></a></span><span> </span><span id="local-6989586621679097172"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097172"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097173"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097172"><span class="hs-identifier hs-var">v'</span></a></span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | Sum over several vectors</span><span>
</span><span id="line-25"></span><span id="local-6989586621679097280"><span id="local-6989586621679097281"><span class="annot"><a href="Drawing.Vector.html#sumV"><span class="hs-identifier hs-type">sumV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679097281"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097280"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097281"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097280"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097280"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-26"></span><span id="sumV"><span class="annot"><span class="annottext">sumV :: forall (f :: * -&gt; *) v. (Foldable f, AdditiveGroup v) =&gt; f v -&gt; v
</span><a href="Drawing.Vector.html#sumV"><span class="hs-identifier hs-var hs-var">sumV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; f v -&gt; v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">(^+^)</span></a></span><span> </span><span class="annot"><span class="annottext">v
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span>
</span><span id="line-27"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Drawing.Vector.html#sumV"><span class="hs-pragma hs-type">sumV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-type">*^</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Vector space @v@.</span><span>
</span><span id="line-34"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="VectorSpace"><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-var">VectorSpace</span></a></span></span><span> </span><span id="local-6989586621679097274"><span class="annot"><a href="#local-6989586621679097274"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span id="local-6989586621679097274"><span class="annot"><a href="#local-6989586621679097274"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-comment">-- | Scale a vector</span><span>
</span><span id="line-37"></span><span>  </span><span id="%2A%5E"><span class="annot"><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-type">(*^)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097274"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097274"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Vector divided by scalar</span><span>
</span><span id="line-40"></span><span id="local-6989586621679097271"><span id="local-6989586621679097272"><span class="annot"><a href="Drawing.Vector.html#%5E%2F"><span class="hs-operator hs-type">(^/)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097272"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097271"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097272"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679097271"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097272"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097271"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097272"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-41"></span><span id="local-6989586621679097153"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097153"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="%5E%2F"><span class="annot"><span class="annottext">^/ :: forall v s.
(VectorSpace v, s ~ Scalar v, Fractional s) =&gt;
v -&gt; s -&gt; v
</span><a href="Drawing.Vector.html#%5E%2F"><span class="hs-operator hs-var hs-var">^/</span></a></span></span><span> </span><span id="local-6989586621679097152"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679097152"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; s
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679097152"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar v -&gt; v -&gt; v
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097153"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-42"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">^/</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Vector multiplied by scalar</span><span>
</span><span id="line-45"></span><span id="local-6989586621679097265"><span id="local-6989586621679097266"><span class="annot"><a href="Drawing.Vector.html#%5E%2A"><span class="hs-operator hs-type">(^*)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097266"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097265"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097266"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097266"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097265"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097266"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-46"></span><span id="%5E%2A"><span class="annot"><span class="annottext">^* :: forall v s. (VectorSpace v, s ~ Scalar v) =&gt; v -&gt; s -&gt; v
</span><a href="Drawing.Vector.html#%5E%2A"><span class="hs-operator hs-var hs-var">(^*)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; v -&gt; v) -&gt; v -&gt; s -&gt; v
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; v -&gt; v
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">(*^)</span></a></span><span>
</span><span id="line-47"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">^*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-type">&lt;.&gt;</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Inner product space @v@.</span><span>
</span><span id="line-54"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097259"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097259"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="InnerSpace"><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-var">InnerSpace</span></a></span></span><span> </span><span id="local-6989586621679097259"><span class="annot"><a href="#local-6989586621679097259"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-comment">-- | Inner/dot product</span><span>
</span><span id="line-56"></span><span>  </span><span id="%3C.%3E"><span class="annot"><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-type">(&lt;.&gt;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097259"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097259"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097259"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Square of the length of a vector.  Sometimes useful for efficiency.</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- See also 'magnitude'.</span><span>
</span><span id="line-60"></span><span id="local-6989586621679097256"><span id="local-6989586621679097257"><span class="annot"><a href="Drawing.Vector.html#magnitudeSq"><span class="hs-identifier hs-type">magnitudeSq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097257"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097256"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097257"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097257"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097256"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-61"></span><span id="magnitudeSq"><span class="annot"><span class="annottext">magnitudeSq :: forall v s. (InnerSpace v, s ~ Scalar v) =&gt; v -&gt; s
</span><a href="Drawing.Vector.html#magnitudeSq"><span class="hs-identifier hs-var hs-var">magnitudeSq</span></a></span></span><span> </span><span id="local-6989586621679097132"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097132"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097132"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; Scalar v
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097132"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-62"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Drawing.Vector.html#magnitudeSq"><span class="hs-pragma hs-type">magnitudeSq</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | Length of a vector.   See also 'magnitudeSq'.</span><span>
</span><span id="line-65"></span><span id="local-6989586621679097252"><span id="local-6989586621679097253"><span class="annot"><a href="Drawing.Vector.html#magnitude"><span class="hs-identifier hs-type">magnitude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097253"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097252"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097253"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679097252"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679097253"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097252"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-66"></span><span id="magnitude"><span class="annot"><span class="annottext">magnitude :: forall v s. (InnerSpace v, s ~ Scalar v, Floating s) =&gt; v -&gt; s
</span><a href="Drawing.Vector.html#magnitude"><span class="hs-identifier hs-var hs-var">magnitude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; s
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">(s -&gt; s) -&gt; (v -&gt; s) -&gt; v -&gt; s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; s
forall v s. (InnerSpace v, s ~ Scalar v) =&gt; v -&gt; s
</span><a href="Drawing.Vector.html#magnitudeSq"><span class="hs-identifier hs-var">magnitudeSq</span></a></span><span>
</span><span id="line-67"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Drawing.Vector.html#magnitude"><span class="hs-pragma hs-type">magnitude</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Vector in same direction as given one but with length of one.  If</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- given the zero vector, then return it.</span><span>
</span><span id="line-71"></span><span id="local-6989586621679097244"><span id="local-6989586621679097245"><span class="annot"><a href="Drawing.Vector.html#normalized"><span class="hs-identifier hs-type">normalized</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097245"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097245"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679097244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679097245"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097245"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-72"></span><span id="normalized"><span class="annot"><span class="annottext">normalized :: forall v s. (InnerSpace v, s ~ Scalar v, Floating s) =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#normalized"><span class="hs-identifier hs-var hs-var">normalized</span></a></span></span><span> </span><span id="local-6989586621679097100"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097100"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097100"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; s -&gt; v
forall v s.
(VectorSpace v, s ~ Scalar v, Fractional s) =&gt;
v -&gt; s -&gt; v
</span><a href="Drawing.Vector.html#%5E%2F"><span class="hs-operator hs-var">^/</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; s
forall v s. (InnerSpace v, s ~ Scalar v, Floating s) =&gt; v -&gt; s
</span><a href="Drawing.Vector.html#magnitude"><span class="hs-identifier hs-var">magnitude</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097100"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-73"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Drawing.Vector.html#normalized"><span class="hs-pragma hs-type">normalized</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Instances</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679097093"><span class="annot"><span class="annottext">zeroV :: Int
</span><a href="#local-6989586621679097093"><span class="hs-identifier hs-var hs-var hs-var hs-var">zeroV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679097090"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097090"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679097089"><span class="annot"><span class="annottext">^+^ :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679097089"><span class="hs-operator hs-var hs-var hs-var hs-var">^+^</span></a></span></span><span> </span><span id="local-6989586621679097088"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097088"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097090"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097088"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679097085"><span class="annot"><span class="annottext">negateV :: Int -&gt; Int
</span><a href="#local-6989586621679097085"><span class="hs-identifier hs-var hs-var hs-var hs-var">negateV</span></a></span></span><span> </span><span id="local-6989586621679097084"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097084"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097084"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679097082"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097082"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679097081"><span class="annot"><span class="annottext">^-^ :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679097081"><span class="hs-operator hs-var hs-var hs-var hs-var">^-^</span></a></span></span><span> </span><span id="local-6989586621679097080"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097080"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097082"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097080"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- but Int is not an instance of VectorSpace</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679097074"><span class="annot"><span class="annottext">zeroV :: Double
</span><a href="#local-6989586621679097074"><span class="hs-identifier hs-var hs-var hs-var hs-var">zeroV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679097071"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097071"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679097070"><span class="annot"><span class="annottext">^+^ :: Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679097070"><span class="hs-operator hs-var hs-var hs-var hs-var">^+^</span></a></span></span><span> </span><span id="local-6989586621679097069"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097069"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097071"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097069"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679097067"><span class="annot"><span class="annottext">negateV :: Double -&gt; Double
</span><a href="#local-6989586621679097067"><span class="hs-identifier hs-var hs-var hs-var hs-var">negateV</span></a></span></span><span> </span><span id="local-6989586621679097066"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097066"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097066"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679097064"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097064"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679097063"><span class="annot"><span class="annottext">^-^ :: Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679097063"><span class="hs-operator hs-var hs-var hs-var hs-var">^-^</span></a></span></span><span> </span><span id="local-6989586621679097062"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097062"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097064"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097062"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679097055"><span class="annot"><span class="annottext">Scalar Double
</span><a href="#local-6989586621679097055"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679097054"><span class="annot"><span class="annottext">*^ :: Scalar Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679097054"><span class="hs-operator hs-var hs-var hs-var hs-var">*^</span></a></span></span><span> </span><span id="local-6989586621679097053"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097053"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
Scalar Double
</span><a href="#local-6989586621679097055"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679097053"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679097042"><span class="annot"><span class="annottext">&lt;.&gt; :: Double -&gt; Double -&gt; Scalar Double
</span><a href="#local-6989586621679097042"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;.&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Scalar Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621679097239"><span id="local-6989586621679097240"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097037"><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097240"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097239"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097240"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097239"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679097034"><span class="annot"><span class="annottext">zeroV :: (u, v)
</span><a href="#local-6989586621679097034"><span class="hs-identifier hs-var hs-var hs-var hs-var">zeroV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679097031"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097031"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097030"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097030"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097029"><span class="annot"><span class="annottext">^+^ :: (u, v) -&gt; (u, v) -&gt; (u, v)
</span><a href="#local-6989586621679097029"><span class="hs-operator hs-var hs-var hs-var hs-var">^+^</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097028"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097028"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097027"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097027"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097031"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">u -&gt; u -&gt; u
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097028"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097030"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097027"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679097024"><span class="annot"><span class="annottext">negateV :: (u, v) -&gt; (u, v)
</span><a href="#local-6989586621679097024"><span class="hs-identifier hs-var hs-var hs-var hs-var">negateV</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097023"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097023"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097022"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097022"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u -&gt; u
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097023"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097022"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679097233"><span id="local-6989586621679097234"><span id="local-6989586621679097235"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097235"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097234"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097235"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-106"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097233"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097234"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097233"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097235"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097233"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span id="local-6989586621679097233"><span id="local-6989586621679097235"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097235"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097233"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097235"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621679097003"><span class="annot"><span class="annottext">Scalar (u, v)
</span><a href="#local-6989586621679097003"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679097002"><span class="annot"><span class="annottext">*^ :: Scalar (u, v) -&gt; (u, v) -&gt; (u, v)
</span><a href="#local-6989586621679097002"><span class="hs-operator hs-var hs-var hs-var hs-var">*^</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097001"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097001"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097000"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097000"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar u
Scalar (u, v)
</span><a href="#local-6989586621679097003"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar u -&gt; u -&gt; u
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679097001"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar v
Scalar (u, v)
</span><a href="#local-6989586621679097003"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar v -&gt; v -&gt; v
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679097000"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679097227"><span id="local-6989586621679097228"><span id="local-6989586621679097229"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097229"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097228"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097229"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-111"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097227"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097228"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097227"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097229"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097227"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096972"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096972"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096971"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096971"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096970"><span class="annot"><span class="annottext">&lt;.&gt; :: (u, v) -&gt; (u, v) -&gt; Scalar (u, v)
</span><a href="#local-6989586621679096970"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;.&gt;</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096969"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096969"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096968"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096968"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096972"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">u -&gt; u -&gt; Scalar u
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096969"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096971"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; Scalar v
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096968"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621679097224"><span id="local-6989586621679097225"><span id="local-6989586621679097226"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096963"><span class="hs-special">(</span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097226"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097225"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097224"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097226"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097225"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097224"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679096959"><span class="annot"><span class="annottext">zeroV :: (u, v, w)
</span><a href="#local-6989586621679096959"><span class="hs-identifier hs-var hs-var hs-var hs-var">zeroV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096955"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096955"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096954"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096954"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096953"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096953"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096952"><span class="annot"><span class="annottext">^+^ :: (u, v, w) -&gt; (u, v, w) -&gt; (u, v, w)
</span><a href="#local-6989586621679096952"><span class="hs-operator hs-var hs-var hs-var hs-var">^+^</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096951"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096951"><span class="hs-identifier hs-var">u'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096950"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096950"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096949"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096949"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096955"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">u -&gt; u -&gt; u
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096951"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096954"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096950"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096953"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096949"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679096945"><span class="annot"><span class="annottext">negateV :: (u, v, w) -&gt; (u, v, w)
</span><a href="#local-6989586621679096945"><span class="hs-identifier hs-var hs-var hs-var hs-var">negateV</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096944"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096944"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096943"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096943"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096942"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096942"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u -&gt; u
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096944"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096943"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w -&gt; w
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096942"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679097216"><span id="local-6989586621679097217"><span id="local-6989586621679097218"><span id="local-6989586621679097219"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097219"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097218"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097219"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-121"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097217"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097218"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097217"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-122"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097216"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097218"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097216"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097219"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097217"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097216"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span id="local-6989586621679097216"><span id="local-6989586621679097217"><span id="local-6989586621679097219"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097219"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097217"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097216"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097219"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679096916"><span class="annot"><span class="annottext">Scalar (u, v, w)
</span><a href="#local-6989586621679096916"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679096915"><span class="annot"><span class="annottext">*^ :: Scalar (u, v, w) -&gt; (u, v, w) -&gt; (u, v, w)
</span><a href="#local-6989586621679096915"><span class="hs-operator hs-var hs-var hs-var hs-var">*^</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096914"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096914"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096913"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096913"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096912"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096912"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar u
Scalar (u, v, w)
</span><a href="#local-6989586621679096916"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar u -&gt; u -&gt; u
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096914"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar v
Scalar (u, v, w)
</span><a href="#local-6989586621679096916"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar v -&gt; v -&gt; v
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096913"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar w
Scalar (u, v, w)
</span><a href="#local-6989586621679096916"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar w -&gt; w -&gt; w
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096912"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679097208"><span id="local-6989586621679097209"><span id="local-6989586621679097210"><span id="local-6989586621679097211"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097211"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097210"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097211"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-127"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097209"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097210"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097209"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-128"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097208"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097210"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097208"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097211"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097209"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097208"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679096875"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096875"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096874"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096873"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096873"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096872"><span class="annot"><span class="annottext">&lt;.&gt; :: (u, v, w) -&gt; (u, v, w) -&gt; Scalar (u, v, w)
</span><a href="#local-6989586621679096872"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;.&gt;</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096871"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096871"><span class="hs-identifier hs-var">u'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096870"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096870"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096869"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096869"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096875"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">u -&gt; u -&gt; Scalar u
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679096871"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; Scalar v
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679096870"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">^+^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096873"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Scalar w
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679096869"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679097207"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096864"><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097207"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679097207"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679096862"><span class="annot"><span class="annottext">zeroV :: [a]
</span><a href="#local-6989586621679096862"><span class="hs-identifier hs-var hs-var hs-var hs-var">zeroV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">a
forall v. AdditiveGroup v =&gt; v
</span><a href="Drawing.Vector.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679096859"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096859"><span class="hs-identifier hs-var">xs1</span></a></span></span><span> </span><span id="local-6989586621679096858"><span class="annot"><span class="annottext">^+^ :: [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679096858"><span class="hs-operator hs-var hs-var hs-var hs-var">^+^</span></a></span></span><span> </span><span id="local-6989586621679096857"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096857"><span class="hs-identifier hs-var">xs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%5E%2B%5E"><span class="hs-operator hs-var">(^+^)</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096859"><span class="hs-identifier hs-var">xs1</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096857"><span class="hs-identifier hs-var">xs2</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679096854"><span class="annot"><span class="annottext">negateV :: [a] -&gt; [a]
</span><a href="#local-6989586621679096854"><span class="hs-identifier hs-var hs-var hs-var hs-var">negateV</span></a></span></span><span> </span><span id="local-6989586621679096853"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096853"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Drawing.Vector.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096853"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679097199"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097199"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679097199"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span id="local-6989586621679097199"><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679097199"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Drawing.Vector.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097199"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679096845"><span class="annot"><span class="annottext">Scalar [a]
</span><a href="#local-6989586621679096845"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679096844"><span class="annot"><span class="annottext">*^ :: Scalar [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679096844"><span class="hs-operator hs-var hs-var hs-var hs-var">*^</span></a></span></span><span> </span><span id="local-6989586621679096843"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096843"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar a
Scalar [a]
</span><a href="#local-6989586621679096845"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar a -&gt; a -&gt; a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Drawing.Vector.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096843"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679097197"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Drawing.Vector.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679097197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679096828"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096828"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679096827"><span class="annot"><span class="annottext">&lt;.&gt; :: [a] -&gt; [a] -&gt; Scalar [a]
</span><a href="#local-6989586621679096827"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;.&gt;</span></a></span></span><span> </span><span id="local-6989586621679096826"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096826"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scalar a] -&gt; Scalar a
forall (f :: * -&gt; *) v. (Foldable f, AdditiveGroup v) =&gt; f v -&gt; v
</span><a href="Drawing.Vector.html#sumV"><span class="hs-identifier hs-var">sumV</span></a></span><span> </span><span class="annot"><span class="annottext">([Scalar a] -&gt; Scalar a) -&gt; [Scalar a] -&gt; Scalar a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Scalar a) -&gt; [a] -&gt; [a] -&gt; [Scalar a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Scalar a
forall v. InnerSpace v =&gt; v -&gt; v -&gt; Scalar v
</span><a href="Drawing.Vector.html#%3C.%3E"><span class="hs-operator hs-var">(&lt;.&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096828"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679096826"><span class="hs-identifier hs-var">xs'</span></a></span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span></pre></body></html>